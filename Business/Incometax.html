<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fixvity — Income Tax Calculator (Premium Teal Edition)</title>

<!-- FONT -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<!-- PNG Export Library -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
/* ----------------------------------------------------
   FIXVITY PREMIUM TEAL THEME — GLOBAL
-----------------------------------------------------*/
:root{
  --teal:#0b7285;
  --bg:#f4f8fb;
  --card:#ffffff;
  --border:rgba(0,0,0,0.12);
  --muted:#6b7176;
  --danger:#d12b2b;
  --success:#0b8a2b;
  font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial;
}

*{
  box-sizing:border-box;
  margin:0;
  padding:0;
}

body{
  background:var(--bg);
  padding:16px;
  color:#0b1720;
}

/* ----------------------------------------------------
   WRAPPER & CARD
-----------------------------------------------------*/
.wrapper{
  max-width:900px;
  margin:0 auto;
}

.card{
  background:var(--card);
  padding:16px;
  border-radius:14px;
  box-shadow:0 3px 9px rgba(0,0,0,0.06);
  margin-bottom:16px;
}

/* ----------------------------------------------------
   TITLE BAR
-----------------------------------------------------*/
.titleBar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#ffffff;
  padding:18px;
  border-radius:14px;
  box-shadow:0 2px 10px rgba(0,0,0,0.06);
  margin-bottom:16px;
}

.titleBar h1{
  font-size:28px;
  font-weight:800;
}

.brand{
  color:var(--muted);
  font-size:14px;
  font-weight:700;
}

/* ----------------------------------------------------
   SECTION HEADERS (STYLE B — SOLID TEAL)
-----------------------------------------------------*/
.sectionTitle{
  background:var(--teal);
  padding:10px 12px;
  color:white;
  font-size:18px;
  font-weight:800;
  border-radius:8px;
  margin-bottom:14px;
}

/* ----------------------------------------------------
   GRID LAYOUT
-----------------------------------------------------*/
.row{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:14px;
}

@media(max-width:600px){
  .row{ grid-template-columns:1fr; }
}

/* ----------------------------------------------------
   INPUT FIELDS
-----------------------------------------------------*/
label{
  font-size:14px;
  font-weight:600;
  color:#0b1720;
  margin-bottom:6px;
  display:block;
}

input, select{
  width:100%;
  padding:10px;
  font-size:15px;
  border-radius:10px;
  border:1px solid var(--border);
  background:white;
}

/* ----------------------------------------------------
   BUTTONS
-----------------------------------------------------*/
.btnRow{
  display:flex;
  gap:12px;
  margin-bottom:18px;
}

.btn{
  padding:10px 16px;
  font-weight:800;
  border:none;
  border-radius:10px;
  cursor:pointer;
  background:#e6ecef;
}

.btn:hover{ background:#d9e1e5; }

.tealBtn{
  background:var(--teal);
  color:white;
}

.tealBtn:hover{
  background:#095f6d;
}

/* ----------------------------------------------------
   RESULTS SECTION
-----------------------------------------------------*/
.resultsBox{
  background:white;
  padding:20px;
  border-radius:14px;
  box-shadow:0 3px 12px rgba(0,0,0,0.06);
  margin-bottom:18px;
}

.refundTop{
  text-align:center;
  margin-bottom:20px;
}

#refundAmount{
  font-size:40px;
  font-weight:800;
  margin-bottom:4px;
}

.refundPositive{ color:var(--success); }
.refundNegative{ color:var(--danger); }

#refundLabel{
  font-size:15px;
  color:var(--muted);
}

/* Result Table */
.resultTable{
  width:100%;
  border-collapse:collapse;
  margin-bottom:20px;
  font-size:15px;
}

.resultTable td{
  padding:10px 8px;
  border-bottom:1px solid rgba(0,0,0,0.08);
}

.resultTable td:last-child{
  text-align:right;
  font-weight:700;
}

/* ----------------------------------------------------
   ADVANCED DETAILS (COLLAPSIBLE)
-----------------------------------------------------*/
.advToggle{
  font-weight:800;
  color:var(--teal);
  cursor:pointer;
  margin-bottom:10px;
}

.advBox{
  display:none;
  padding:14px;
  background:white;
  border-radius:10px;
  border:1px solid var(--border);
}

.advTable td{
  padding:8px 4px;
  border-bottom:1px solid rgba(0,0,0,0.06);
}

.advTable td:last-child{
  text-align:right;
  font-weight:700;
}
</style>
</head>

<body>

<div class="wrapper">

<!-- TITLE BAR -->
<div class="titleBar">
  <h1>Income Tax Calculator</h1>
  <div class="brand">Fixvity</div>
</div>

<!-- =============================== -->
<!-- INPUTS SECTION -->
<!-- =============================== -->
<div class="card">
  <div class="sectionTitle">Basic Information</div>

  <div class="row">
    <div>
      <label>Filing Status</label>
      <select id="filing">
        <option value="single">Single</option>
        <option value="married_joint">Married Filing Jointly</option>
        <option value="married_separate">Married Filing Separately</option>
        <option value="head">Head of Household</option>
        <option value="widow">Qualified Widow(er)</option>
      </select>
    </div>

    <div>
      <label>Age</label>
      <input id="age" type="number" placeholder="30" />
    </div>

    <div>
      <label>Tax Year</label>
      <select id="taxYear">
        <option>2024</option>
        <option>2025</option>
        <option>2026</option>
        <option>2027</option>
        <option>2028</option>
      </select>
    </div>

    <div>
      <label>Currency</label>
      <select id="currency">
        <option value="USD">$ USD</option>
        <option value="INR">₹ INR</option>
        <option value="EUR">€ EUR</option>
      </select>
    </div>
  </div>
</div>

<!-- =============================== -->
<!-- INCOME SECTION -->
<!-- =============================== -->
<div class="card">
  <div class="sectionTitle">Income Details</div>

  <div class="row">
    <div><label>Wages</label><input id="wages" type="number" value="0"></div>
    <div><label>Interest</label><input id="interest" type="number" value="0"></div>
    <div><label>Dividends</label><input id="dividends" type="number" value="0"></div>
    <div><label>Short-Term Capital Gains</label><input id="stcg" type="number" value="0"></div>
    <div><label>Long-Term Capital Gains</label><input id="ltcg" type="number" value="0"></div>
    <div><label>Other Income</label><input id="otherIncome" type="number" value="0"></div>
  </div>
</div>

<!-- =============================== -->
<!-- DEDUCTIONS SECTION -->
<!-- =============================== -->
<div class="card">
  <div class="sectionTitle">Deductions</div>

  <div class="row">
    <div><label>Mortgage Interest</label><input id="mortgage" type="number" value="0"></div>
    <div><label>Charitable Donations</label><input id="charity" type="number" value="0"></div>
    <div><label>Student Loan Interest</label><input id="studentLoan" type="number" value="0"></div>
  </div>
</div>

<!-- =============================== -->
<!-- CREDITS SECTION -->
<!-- =============================== -->
<div class="card">
  <div class="sectionTitle">Credits</div>

  <div class="row">
    <div><label>Child Tax Credit</label><input id="childCredit" type="number" value="0"></div>
    <div><label>Education Credit</label><input id="eduCredit" type="number" value="0"></div>
  </div>
</div>

<!-- =============================== -->
<!-- PREPAYMENTS -->
<!-- =============================== -->
<div class="card">
  <div class="sectionTitle">Tax Withholding & Prepayments</div>

  <div class="row">
    <div><label>Federal Withheld</label><input id="withheld" type="number" value="0"></div>
    <div><label>State Withheld</label><input id="stateWithheld" type="number" value="0"></div>
    <div><label>Estimated Payments</label><input id="prepay" type="number" value="0"></div>
    <div><label>State Tax Rate (%)</label><input id="stateRate" type="number" value="0"></div>
  </div>

  <div class="btnRow">
    <button class="btn tealBtn" id="calculateBtn">Calculate</button>
    <button class="btn" id="exportPNG">Download PNG</button>
  </div>
</div>

<!-- RESULTS BOX (JS will fill) -->
<div id="resultsBox" class="resultsBox">
  <!-- Filled by JS -->
</div>
<script>
/* ---------------------------------------------------------
   FIXVITY — INCOME TAX CALCULATOR (PREMIUM TEAL EDITION)
   JS ENGINE — Complete IRS logic + UI rendering
----------------------------------------------------------*/

const $ = id => document.getElementById(id);

/* Currency formatter */
function fmt(n, cur){
  const sym = { USD:'$', INR:'₹', EUR:'€' }[cur] || '$';
  return sym + Number(n).toLocaleString();
}

/* IRS Standard Deduction (2024→2028 stable values) */
function getStandardDeduction(filing, age){
  const base = {
    single:14600,
    married_joint:29200,
    married_separate:14600,
    head:21900,
    widow:29200
  };
  let sd = base[filing] || 14600;

  // Age 65+ add-on
  if(age >= 65){
    if(filing === 'single' || filing === 'head'){
      sd += 1900;
    } else {
      sd += 1500;
    }
  }
  return sd;
}

/* IRS Tax Brackets (2024 values applied forward) */
const BRACKETS = {
  single:[
    [0,0.10],[11600,0.12],[47150,0.22],[100525,0.24],
    [191950,0.32],[243725,0.35],[609350,0.37]
  ],
  married_joint:[
    [0,0.10],[23200,0.12],[94300,0.22],[201050,0.24],
    [383900,0.32],[487450,0.35],[731200,0.37]
  ],
  married_separate:[
    [0,0.10],[11600,0.12],[47150,0.22],[100525,0.24],
    [191950,0.32],[243725,0.35],[365600,0.37]
  ],
  head:[
    [0,0.10],[16550,0.12],[63100,0.22],[100500,0.24],
    [191950,0.32],[243700,0.35],[609350,0.37]
  ],
  widow:[
    [0,0.10],[23200,0.12],[94300,0.22],[201050,0.24],
    [383900,0.32],[487450,0.35],[731200,0.37]
  ]
};

/* Compute federal tax based on progressive brackets */
function computeBracketTax(taxable, filing){
  const b = BRACKETS[filing];
  let tax = 0;

  for(let i=0; i<b.length; i++){
    const [start, rate] = b[i];
    const end = (i < b.length-1 ? b[i+1][0] : Infinity);
    if(taxable > start){
      const amt = Math.min(taxable, end) - start;
      tax += amt * rate;
    }
  }
  return tax;
}

/* -------------------------------
   MAIN CALCULATE FUNCTION
--------------------------------*/
function calculateTax(){
  const cur = $('currency').value;
  const filing = $('filing').value;
  const age = Number($('age').value);
  const year = $('taxYear').value;

  /* INCOME */
  const wages = Number($('wages').value)||0;
  const interest = Number($('interest').value)||0;
  const dividends = Number($('dividends').value)||0;
  const stcg = Number($('stcg').value)||0;
  const ltcg = Number($('ltcg').value)||0;
  const other = Number($('otherIncome').value)||0;

  const totalIncome = wages + interest + dividends + stcg + ltcg + other;

  /* DEDUCTIONS */
  const mortgage = Number($('mortgage').value)||0;
  const charity = Number($('charity').value)||0;
  const studentLoan = Number($('studentLoan').value)||0;

  const itemized = mortgage + charity + studentLoan;
  const standard = getStandardDeduction(filing, age);

  const deductionUsed = Math.max(itemized, standard);
  const taxable = Math.max(0, totalIncome - deductionUsed);

  /* FEDERAL TAX */
  const fedTax = computeBracketTax(taxable, filing);

  /* CREDITS */
  const ctc = Number($('childCredit').value)||0;
  const edu = Number($('eduCredit').value)||0;
  const creditsTotal = ctc + edu;

  const taxAfterCredits = fedTax - creditsTotal;

  /* STATE TAX */
  const stateRate = Number($('stateRate').value)||0;
  const stateTax = taxable * (stateRate/100);

  /* PREPAYMENTS */
  const withFed = Number($('withheld').value)||0;
  const withState = Number($('stateWithheld').value)||0;
  const prepay = Number($('prepay').value)||0;

  const preTotal = withFed + withState + prepay;

  /* FINAL REFUND / DUE */
  const final = preTotal - taxAfterCredits;

  /* TAX RATE INFORMATION */
  const marginalBracket = BRACKETS[filing].filter(b=>taxable>=b[0]).pop()[1] * 100;
  const effectiveRate = taxable > 0 ? (fedTax / taxable) * 100 : 0;

  /* ------------------------------
     RENDER RESULTS SECTION
  ------------------------------*/
  $('resultsBox').innerHTML = `
    <div class="refundTop">
        <div id="refundAmount" class="${
          final>=0?'refundPositive':'refundNegative'
        }">
          ${final>=0 ? fmt(final,cur) : "Due " + fmt(Math.abs(final),cur)}
        </div>
        <div id="refundLabel">Estimated Refund / Amount Due</div>
    </div>

    <table class="resultTable">
      <tr><td>Total Income</td><td>${fmt(totalIncome,cur)}</td></tr>
      <tr><td>Deductions Used</td><td>${fmt(deductionUsed,cur)}</td></tr>
      <tr><td>Taxable Income</td><td>${fmt(taxable,cur)}</td></tr>
      <tr><td>Federal Tax</td><td>${fmt(fedTax,cur)}</td></tr>
      <tr><td>Credits Applied</td><td>${fmt(creditsTotal,cur)}</td></tr>
      <tr><td>State Tax</td><td>${fmt(stateTax,cur)}</td></tr>
      <tr><td>Total Prepayments</td><td>${fmt(preTotal,cur)}</td></tr>
    </table>

    <div class="advToggle" onclick="
      const box = document.getElementById('advBox');
      box.style.display = box.style.display==='block'?'none':'block';
    ">
      ▸ Show Advanced Details
    </div>

    <div id="advBox" class="advBox">

      <table class="advTable" style="width:100%">
        <tr>
          <td><strong>Adjusted Gross Income (AGI)</strong><br>
          <span class="muted">Total income minus adjustments</span></td>
          <td>${fmt(totalIncome,cur)}</td>
        </tr>

        <tr>
          <td><strong>Taxable Income</strong><br>
          <span class="muted">AGI minus deductions</span></td>
          <td>${fmt(taxable,cur)}</td>
        </tr>

        <tr>
          <td><strong>Federal Tax Bracket Used</strong><br>
          <span class="muted">Based on IRS filing status</span></td>
          <td>${marginalBracket.toFixed(1)}%</td>
        </tr>

        <tr>
          <td><strong>Marginal Tax Rate</strong><br>
          <span class="muted">Rate applied to your last dollar</span></td>
          <td>${marginalBracket.toFixed(1)}%</td>
        </tr>

        <tr>
          <td><strong>Effective Tax Rate</strong><br>
          <span class="muted">Total tax ÷ taxable income</span></td>
          <td>${effectiveRate.toFixed(1)}%</td>
        </tr>

        <tr>
          <td><strong>Federal Tax Before Credits</strong><br>
          <span class="muted">Total tax based on brackets</span></td>
          <td>${fmt(fedTax,cur)}</td>
        </tr>

        <tr>
          <td><strong>Credits Reducing Tax</strong><br>
          <span class="muted">Child, education & other credits</span></td>
          <td>${fmt(creditsTotal,cur)}</td>
        </tr>

        <tr>
          <td><strong>State Tax Estimate</strong><br>
          <span class="muted">Based on provided state rate</span></td>
          <td>${fmt(stateTax,cur)}</td>
        </tr>

        <tr>
          <td><strong>Total Federal Prepayments</strong><br>
          <span class="muted">Withheld + estimated payments</span></td>
          <td>${fmt(preTotal,cur)}</td>
        </tr>
      </table>

    </div>
  `;
}

/* ------------------------------
   PNG Export (RESULTS ONLY)
------------------------------*/
$('exportPNG').addEventListener('click', ()=>{
  html2canvas($('resultsBox')).then(canvas=>{
      const a = document.createElement('a');
      a.href = canvas.toDataURL("image/png");
      a.download = "tax_results.png";
      a.click();
  });
});

/* ------------------------------
   EVENT: Calculate
------------------------------*/
$('calculateBtn').addEventListener('click', calculateTax);

/* Auto calculate on load */
calculateTax();
</script>
</body>
</html>
