<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Income Tax Calculator — Currency conversion</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f4f6f8; --card:#ffffff; --accent:#2b7a4a; --muted:#6b7176;
    --panel:#e9f6f0; --border:rgba(10,20,30,0.08);
    font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:#0b1720;-webkit-font-smoothing:antialiased}
  .wrap{max-width:1100px;margin:18px auto;padding:14px}
  .card{background:var(--card);border-radius:14px;padding:14px;border:1px solid var(--border);box-shadow:0 8px 18px rgba(12,18,24,0.04)}
  .header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
  .title{font-size:20px;margin:0;font-weight:800}
  .subtitle{color:var(--muted);font-size:13px}
  .grid{display:grid;grid-template-columns:1fr 380px;gap:16px}
  @media(max-width:980px){ .grid{grid-template-columns:1fr} }

  /* form */
  form{display:flex;flex-direction:column;gap:12px}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .col{flex:1;min-width:120px}
  label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
  input[type="text"], input[type="number"], select{width:100%;padding:12px;border-radius:10px;border:1px solid var(--border);font-size:15px;background:#fff}
  .big{font-size:18px;padding:14px}
  .group{padding:10px;border-radius:10px;background:#fff;border:1px solid var(--border)}
  .sectionTitle{background:#154a6a;color:#fff;padding:6px 10px;border-radius:8px;font-weight:700;margin-bottom:8px}

  .controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .btn{padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
  .btnPrimary{background:var(--accent);color:#fff}
  .btnGhost{background:#fff;border:1px solid var(--border);color:#0b1720}
  .btnWarn{background:#f59e0b;color:#fff}

  /* results panel (right column) */
  .results{padding:14px;border-radius:10px;background:linear-gradient(180deg,#fff,#fbf);border:1px solid var(--border)}
  .resultHeader{display:flex;align-items:center;justify-content:space-between}
  .bigNum{font-size:36px;font-weight:800;color:var(--accent)}
  .fsRight{font-size:14px;color:var(--muted)}
  .summary{margin-top:12px;border-radius:8px;overflow:hidden}
  .rowItem{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid rgba(12,18,24,0.04);background:#fff}
  .rowItem.bold{font-weight:800;background:var(--panel)}
  .smallNote{font-size:13px;color:var(--muted);margin-top:8px}

  .convBox{display:flex;gap:8px;align-items:center}
  .convBox input{max-width:120px;padding:8px}

  /* compact table for mobile */
  @media(max-width:600px){
    .bigNum{font-size:28px}
    .grid{gap:10px}
    .results{order:-1} /* show results above on mobile */
  }

  footer{margin-top:14px;color:var(--muted);font-size:13px}
  .muted{color:var(--muted)}
  .inline{display:inline-block}
  .flex{display:flex;gap:8px;align-items:center}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="header">
        <div>
          <h1 class="title">Income Tax Calculator</h1>
          <div class="subtitle">Responsive estimator — demo preset available + currency conversion</div>
        </div>

        <div class="controls">
          <label class="muted" style="font-size:13px;margin-right:6px">Current currency</label>
          <select id="currency" aria-label="Currency">
            <option value="USD">$ USD</option>
            <option value="EUR">€ EUR</option>
            <option value="INR">₹ INR</option>
          </select>
          <div class="convBox" title="Editable conversion rates (relative to USD)">
            <label class="muted" style="font-size:13px;margin-right:6px">Rates (1 USD =)</label>
            <input id="rateUSD" type="number" step="0.0001" value="1" />
            <input id="rateEUR" type="number" step="0.0001" value="0.92" />
            <input id="rateINR" type="number" step="0.01" value="83.50" />
          </div>
          <button id="convertBtn" class="btn btnGhost" title="Convert all numeric inputs from current currency to selected target currency">Convert values</button>
          <button id="loadDemo" class="btn btnGhost">Load Demo</button>
        </div>
      </div>

      <div class="grid">
        <!-- LEFT: INPUTS -->
        <div>
          <form id="taxForm" onsubmit="return false;" autocomplete="off">
            <div class="group">
              <div class="sectionTitle">Filing & Basic</div>
              <div class="row">
                <div class="col">
                  <label for="filing">Filing status</label>
                  <select id="filing">
                    <option value="single">Single</option>
                    <option value="married_joint">Married filing jointly</option>
                    <option value="married_separate">Married filing separately</option>
                    <option value="head">Head of household</option>
                    <option value="widow">Qualified widow(er)</option>
                  </select>
                </div>
                <div class="col">
                  <label for="age">Age</label>
                  <input id="age" type="number" min="0" value="30" />
                </div>
                <div class="col">
                  <label for="taxYearSelect">Tax year</label>
                  <select id="taxYearSelect"></select>
                </div>
              </div>
            </div>

            <div class="group" style="margin-top:12px">
              <div class="sectionTitle">Income</div>

              <div class="row">
                <div class="col">
                  <label for="wages">Wages, tips, compensation</label>
                  <input id="wages" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="interest">Interest income</label>
                  <input id="interest" class="num" type="number" value="0" />
                </div>
              </div>

              <div class="row" style="margin-top:8px">
                <div class="col">
                  <label for="dividends">Ordinary dividends</label>
                  <input id="dividends" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="qualifiedDiv">Qualified dividends</label>
                  <input id="qualifiedDiv" class="num" type="number" value="0" />
                </div>
              </div>

              <div class="row" style="margin-top:8px">
                <div class="col">
                  <label for="stcg">Short-term capital gains</label>
                  <input id="stcg" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="ltcg">Long-term capital gains</label>
                  <input id="ltcg" class="num" type="number" value="0" />
                </div>
              </div>

              <div class="row" style="margin-top:8px">
                <div class="col">
                  <label for="selfBiz">Business / Self-employment net</label>
                  <input id="selfBiz" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="passive">Passive / rental / other</label>
                  <input id="passive" class="num" type="number" value="0" />
                </div>
              </div>

              <div class="row" style="margin-top:8px">
                <div class="col">
                  <label for="social">Social security income</label>
                  <input id="social" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="otherIncome">Other income (tips, overtime, pensions)</label>
                  <input id="otherIncome" class="num" type="number" value="0" />
                </div>
              </div>
            </div>

            <div class="group" style="margin-top:12px">
              <div class="sectionTitle">Withholdings & Pre-payments</div>
              <div class="row">
                <div class="col">
                  <label for="fedWithheld">Federal income tax withheld</label>
                  <input id="fedWithheld" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="stateWithheld">State income tax withheld</label>
                  <input id="stateWithheld" class="num" type="number" value="0" />
                </div>
              </div>

              <div class="row" style="margin-top:8px">
                <div class="col">
                  <label for="prepayments">Estimated tax pre-payments</label>
                  <input id="prepayments" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="otherWith">Local / other withheld</label>
                  <input id="otherWith" class="num" type="number" value="0" />
                </div>
              </div>
            </div>

            <div class="group" style="margin-top:12px">
              <div class="sectionTitle">Deductions & Credits</div>

              <div class="row">
                <div class="col">
                  <label for="mortgage">Mortgage interest</label>
                  <input id="mortgage" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="realEstate">Real estate taxes</label>
                  <input id="realEstate" class="num" type="number" value="0" />
                </div>
              </div>

              <div class="row" style="margin-top:8px">
                <div class="col">
                  <label for="charity">Charitable donations</label>
                  <input id="charity" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="studentLoan">Student loan interest</label>
                  <input id="studentLoan" class="num" type="number" value="0" />
                </div>
              </div>

              <div class="row" style="margin-top:8px">
                <div class="col">
                  <label for="ira">IRA contributions</label>
                  <input id="ira" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="otherDed">Other deductibles</label>
                  <input id="otherDed" class="num" type="number" value="0" />
                </div>
              </div>

              <div style="margin-top:8px" class="row">
                <div class="col">
                  <label for="childCare">Child & dependent care (eligible)</label>
                  <input id="childCare" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="college1">College expenses (student 1)</label>
                  <input id="college1" class="num" type="number" value="0" />
                </div>
              </div>

              <div style="margin-top:8px" class="row">
                <div class="col">
                  <label for="ctc">Child tax credit (total)</label>
                  <input id="ctc" class="num" type="number" value="0" />
                </div>
                <div class="col">
                  <label for="otherCredits">Other tax credits</label>
                  <input id="otherCredits" class="num" type="number" value="0" />
                </div>
              </div>
            </div>

            <div style="display:flex;gap:10px;margin-top:12px;align-items:center">
              <button id="calculateBtn" class="btn btnPrimary">Calculate</button>
              <button id="exampleBtn" class="btn btnGhost">Load example</button>
              <button id="clearBtn" class="btn btnGhost">Clear</button>
            </div>

          </form>
        </div>

        <!-- RIGHT: RESULTS -->
        <aside class="results" aria-live="polite">
          <div class="resultHeader">
            <div>
              <div class="muted">Estimated refund / balance for <span id="resYear"></span></div>
              <div id="estAmount" class="bigNum">$0</div>
            </div>
            <div class="fsRight" id="resFiling">Filing: Single</div>
          </div>

          <div class="summary" id="summaryBox" role="region" aria-label="Summary results" style="margin-top:12px">
            <div class="rowItem rowItemTitle rowItem bold">
              <div>Total Income</div><div id="totalIncome">$0</div>
            </div>

            <div class="rowItem">
              <div>Wages & Compensation</div><div id="rWages">$0</div>
            </div>
            <div class="rowItem">
              <div>Interest & Dividends</div><div id="rInterest">$0</div>
            </div>
            <div class="rowItem">
              <div>Capital gains (ST/LT)</div><div id="rCG">$0</div>
            </div>
            <div class="rowItem">
              <div>Business / Passive / Other</div><div id="rOther">$0</div>
            </div>

            <div class="rowItem bold" style="margin-top:6px">
              <div>Total Deductions</div><div id="totalDed">$0</div>
            </div>

            <div class="rowItem">
              <div>Taxable Income</div><div id="taxable">$0</div>
            </div>

            <div class="rowItem bold">
              <div>Regular Taxes (federal)</div><div id="regularTax">$0</div>
            </div>

            <div class="rowItem">
              <div>All Tax Credits</div><div id="allCredits">$0</div>
            </div>

            <div class="rowItem bold">
              <div>Total Tax with Credits</div><div id="taxWithCredits">$0</div>
            </div>

            <div class="rowItem">
              <div>Federal tax withheld + prepayments</div><div id="prepayTotal">$0</div>
            </div>

            <div class="rowItem bold">
              <div>Estimated refund</div><div id="finalRefund">$0</div>
            </div>
          </div>

          <div class="smallNote">This tool provides an estimate. For accurate filing consult a tax professional.</div>
        </aside>
      </div>

      <footer style="margin-top:14px" class="muted">Conversion modifies numeric inputs (you can undo manually). Rates are editable and used for conversion.</footer>
    </div>
  </div>

<script>
/* === helpers and setup === */
const $ = id => document.getElementById(id);
const numericInputs = () => Array.from(document.querySelectorAll('input.num'));
const currencySelector = $('currency');
const rateUSD = $('rateUSD'), rateEUR = $('rateEUR'), rateINR = $('rateINR');

(function setTaxYearOptions(){
  const now = new Date();
  const thisYear = now.getFullYear();
  for(let y=thisYear; y<=thisYear+1; y++){
    const opt = document.createElement('option'); opt.value = y; opt.textContent = y; $('taxYearSelect').appendChild(opt);
  }
  $('taxYearSelect').value = thisYear;
  $('resYear').textContent = $('taxYearSelect').value;
})();
$('taxYearSelect').addEventListener('change', ()=> $('resYear').textContent = $('taxYearSelect').value);

/* currency symbol map */
function symbolFor(curr){
  if(curr==='USD') return '$';
  if(curr==='EUR') return '€';
  if(curr==='INR') return '₹';
  return '';
}

/* formatters */
function fmtCurrency(n){
  const sym = symbolFor(currencySelector.value);
  const val = Number(n) || 0;
  return sym + val.toLocaleString();
}
function fmt(n){ return (Number(n)||0).toLocaleString(); }

/* simplified federal tax (same as previous) */
function computeFederalTax(taxable, filingStatus){
  taxable = Math.max(0, taxable || 0);
  const brackets = {
    single: [
      {rate:0.10, upto:11000},
      {rate:0.12, upto:44725},
      {rate:0.22, upto:95375},
      {rate:0.24, upto:182100},
      {rate:0.32, upto:231250},
      {rate:0.35, upto:578125},
      {rate:0.37, upto:Infinity}
    ],
    married_joint: [
      {rate:0.10, upto:22000},
      {rate:0.12, upto:89450},
      {rate:0.22, upto:190750},
      {rate:0.24, upto:364200},
      {rate:0.32, upto:462500},
      {rate:0.35, upto:693750},
      {rate:0.37, upto:Infinity}
    ],
    head: [
      {rate:0.10, upto:15600},
      {rate:0.12, upto:59750},
      {rate:0.22, upto:95350},
      {rate:0.24, upto:182100},
      {rate:0.32, upto:231250},
      {rate:0.35, upto:578100},
      {rate:0.37, upto:Infinity}
    ],
    married_separate: [
      {rate:0.10, upto:11000},
      {rate:0.12, upto:44725},
      {rate:0.22, upto:95375},
      {rate:0.24, upto:182100},
      {rate:0.32, upto:231250},
      {rate:0.35, upto:346875},
      {rate:0.37, upto:Infinity}
    ],
    widow: [] // will be handled
  };
  const fs = (filingStatus === 'widow') ? 'married_joint' : (filingStatus === 'head' ? 'head' : filingStatus);
  const table = brackets[fs] || brackets.single;
  let remaining = taxable, tax=0, prev=0;
  for(let i=0;i<table.length;i++){
    const b = table[i];
    const upto = b.upto;
    const chunk = Math.max(0, Math.min(remaining, upto - prev));
    if(chunk>0){ tax += chunk * b.rate; remaining -= chunk;}
    prev = upto;
    if(remaining<=0) break;
  }
  return Math.round(tax);
}

/* collect and compute and update UI */
function calculateAll(){
  const wages = Number($('wages').value)||0;
  const interest = Number($('interest').value)||0;
  const dividends = Number($('dividends').value)||0;
  const qualifiedDiv = Number($('qualifiedDiv').value)||0;
  const stcg = Number($('stcg').value)||0;
  const ltcg = Number($('ltcg').value)||0;
  const selfBiz = Number($('selfBiz').value)||0;
  const passive = Number($('passive').value)||0;
  const social = Number($('social').value)||0;
  const otherIncome = Number($('otherIncome').value)||0;

  const totalIncome = wages + interest + dividends + qualifiedDiv + stcg + ltcg + selfBiz + passive + social + otherIncome;

  const mortgage = Number($('mortgage').value)||0;
  const realEstate = Number($('realEstate').value)||0;
  const charity = Number($('charity').value)||0;
  const studentLoan = Number($('studentLoan').value)||0;
  const ira = Number($('ira').value)||0;
  const otherDed = Number($('otherDed').value)||0;
  const childCare = Number($('childCare').value)||0;
  const college1 = Number($('college1').value)||0;

  const ctc = Number($('ctc').value)||0;
  const otherCredits = Number($('otherCredits').value)||0;

  const fedWithheld = Number($('fedWithheld').value)||0;
  const prepayments = Number($('prepayments').value)||0;

  const totalDeductions = mortgage + realEstate + charity + studentLoan + ira + otherDed + childCare + college1;
  const taxableIncome = Math.max(0, Math.round(totalIncome - totalDeductions));
  const regularTax = computeFederalTax(taxableIncome, $('filing').value);
  const allCredits = ctc + otherCredits;
  const taxWithCredits = Math.round(regularTax - allCredits);
  const prepayTotal = fedWithheld + prepayments;
  const estimatedRefund = Math.round(prepayTotal - taxWithCredits);

  // fill UI (format with selected currency)
  $('totalIncome').textContent = fmtCurrency(totalIncome);
  $('rWages').textContent = fmtCurrency(wages);
  $('rInterest').textContent = fmtCurrency(interest + dividends + qualifiedDiv);
  $('rCG').textContent = fmtCurrency(stcg + ltcg);
  $('rOther').textContent = fmtCurrency(selfBiz + passive + otherIncome + social);
  $('totalDed').textContent = fmtCurrency(totalDeductions);
  $('taxable').textContent = fmtCurrency(taxableIncome);
  $('regularTax').textContent = fmtCurrency(regularTax);
  $('allCredits').textContent =  fmtCurrency(allCredits);
  $('taxWithCredits').textContent = fmtCurrency(taxWithCredits);
  $('prepayTotal').textContent = fmtCurrency(prepayTotal);
  $('finalRefund').textContent = fmtCurrency(estimatedRefund);
  $('estAmount').textContent = fmtCurrency(estimatedRefund);

  // filing label
  const filingMap = {single:'Single', married_joint:'Married filing jointly', married_separate:'Married filing separately', head:'Head of household', widow:'Qualified widow(er)'};
  $('resFiling').textContent = 'Filing: ' + (filingMap[$('filing').value] || 'Single');

  return {estimatedRefund};
}

/* currency conversion logic
   rates are stored as value = 1 USD = rateX (editable)
   current currency is currencySelector.value (like 'USD')
   Convert button: converts all numeric inputs from current currency into selected target currency
   Calculation formatting uses selected currency only (does not convert values unless user pressed Convert)
*/
function getRates(){
  // ensure positive numbers
  const rUSD = Math.max(0.000001, Number(rateUSD.value) || 1);
  const rEUR = Math.max(0.000001, Number(rateEUR.value) || 0.92);
  const rINR = Math.max(0.000001, Number(rateINR.value) || 83.5);
  return {USD:rUSD, EUR:rEUR, INR:rINR};
}

function convertValuesTo(target){
  const rates = getRates();
  const current = currencySelector.value;
  if(current === target) { alert('Already in ' + target); return; }
  const fromRate = rates[current];
  const toRate = rates[target];
  if(!fromRate || !toRate){ alert('Invalid rates'); return; }
  const factor = toRate / fromRate; // multiply current values by this factor to get target currency
  // apply to all numeric inputs
  numericInputs().forEach(input=>{
    const v = Number(input.value) || 0;
    // scale and round to 2 decimals for nicer behaviour
    const nv = Math.round((v * factor) * 100) / 100;
    input.value = nv;
  });
  // update currency selector to target
  currencySelector.value = target;
  // refresh results labels (they will be formatted using new currency symbol)
  calculateAll();
}

/* hookup the convert button */
$('convertBtn').addEventListener('click', ()=>{
  // Show a small selector to pick target currency (reuse currency selector)
  const current = currencySelector.value;
  const target = prompt(`Convert all numeric inputs from ${current} to which currency? Enter: USD, EUR or INR`, current);
  if(!target) return;
  const t = target.trim().toUpperCase();
  if(!['USD','EUR','INR'].includes(t)) { alert('Only USD, EUR, INR allowed'); return; }
  convertValuesTo(t);
});

/* currency selector changes just change formatting & symbol (does not convert existing numbers) */
currencySelector.addEventListener('change', ()=> calculateAll());

/* demo preset from earlier example */
const demoValues = {
  wages: 8000,
  interest: 0,
  dividends: 0,
  qualifiedDiv: 0,
  stcg: 0,
  ltcg: 0,
  selfBiz: 0,
  passive: 0,
  social: 0,
  otherIncome: 0,
  mortgage: 0,
  realEstate: 0,
  charity: 0,
  studentLoan: 0,
  ira: 0,
  otherDed: 15750,
  childCare: 0,
  college1: 0,
  ctc: 2720,
  otherCredits: 0,
  fedWithheld: 6000,
  stateWithheld: 0,
  prepayments: 0,
  otherWith: 0,
  filing: 'single',
  age: 30,
  taxYear: Number($('taxYearSelect').value)
};
function fillForm(v){
  $('wages').value = v.wages || 0;
  $('interest').value = v.interest || 0;
  $('dividends').value = v.dividends || 0;
  $('qualifiedDiv').value = v.qualifiedDiv || 0;
  $('stcg').value = v.stcg || 0;
  $('ltcg').value = v.ltcg || 0;
  $('selfBiz').value = v.selfBiz || 0;
  $('passive').value = v.passive || 0;
  $('social').value = v.social || 0;
  $('otherIncome').value = v.otherIncome || 0;
  $('mortgage').value = v.mortgage || 0;
  $('realEstate').value = v.realEstate || 0;
  $('charity').value = v.charity || 0;
  $('studentLoan').value = v.studentLoan || 0;
  $('ira').value = v.ira || 0;
  $('otherDed').value = v.otherDed || 0;
  $('childCare').value = v.childCare || 0;
  $('college1').value = v.college1 || 0;
  $('ctc').value = v.ctc || 0;
  $('otherCredits').value = v.otherCredits || 0;
  $('fedWithheld').value = v.fedWithheld || 0;
  $('stateWithheld').value = v.stateWithheld || 0;
  $('prepayments').value = v.prepayments || 0;
  $('otherWith').value = v.otherWith || 0;
  $('filing').value = v.filing || 'single';
  $('age').value = v.age || 30;
  $('taxYearSelect').value = v.taxYear || $('taxYearSelect').value;
  $('resYear').textContent = $('taxYearSelect').value;
}

/* button handlers */
$('calculateBtn').addEventListener('click', ()=> calculateAll());
$('exampleBtn').addEventListener('click', ()=>{
  fillForm(demoValues);
  calculateAll();
});
$('loadDemo').addEventListener('click', ()=>{
  fillForm(demoValues);
  calculateAll();
});
$('clearBtn').addEventListener('click', ()=>{
  document.getElementById('taxForm').reset();
  // reset rates & currency to defaults (optional)
  rateUSD.value = 1; rateEUR.value = 0.92; rateINR.value = 83.5;
  currencySelector.value = 'USD';
  calculateAll();
});

/* initial render */
calculateAll();
</script>
</body>
</html>
